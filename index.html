<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
	<title>WS修論システム</title>
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="content-script-type" content="text/javascript" />
	
<!-- CSS部分 -->
	<style>
		body {
			font-family: "Helvetica Neue", helvetica, arial;
			padding: 15px;
		}

		ul {
			list-style: none;
			margin: 0;
			padding: 0;
		}

		ul li {
			line-height: 1.4;
		}
	</style>
<!-- CSS部分 -->


<!-- スクリプト部分 -->
	<script>
	//変数定義(websocket必須)
	var host = location.origin.replace(/^http/, 'ws')		//host
	var ws = new WebSocket(host);							//websocket
	//付け加え変数定義
	var ping_msg = document.getElementById('ping_message');		//ping用
	var chat_ipt = document.getElementById('chat_input');
	var chat_btn = document.getElementById('chat_button');
	var chat_fld = document.getElementById('chat_field');
	  
	//サーバからデータ受信時のイベント
	ws.onmessage = function (event) {
		//ping_msg.innerHTML += JSON.parse(event.data);
		ping_msg.innerHTML += "<div>" + JSON.parse(event.data) + "</div>";
		//console.log(JSON.parse(event.data));
	};
	
	
	function send() {
		//サーバに送信
		ws.send(chat_ipt.value);
		chat_fld += chat_ipt.value;
	}

    </script>
<!-- スクリプト部分終わり -->

</head>
<body>
	<!-- chat部分 -->
	<input type="text" id="chat_input"/>
	<input type="button" id="chat_button" value="send" onclick="send()"/>
	<textarea name="chatbox" rows="8" cols="40" id="chat_field">
	</textarea>
	<br>
	
	<!-- pingボックス:通信を切らないために -->
	<textarea name="pingbox" rows="8" cols="40" id="ping_message">
	</textarea>
	
  </body>
</html>
